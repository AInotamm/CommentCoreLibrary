<!DOCTYPE html>

<html lang="en">

<head>
<title>Test Page</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta http-equiv="X-UA-Compatible" value="IE=9">
<link rel="stylesheet" href="style.css" />

<!-- Files Below May Be Combined/Concated into one on Deployment Servers -->
<script src="CommentFilter.js"></script>
<script src="CommentSpaceAllocator.js"></script>
<script src="CommentCoreLibrary.js"></script>

<!-- A few helpers to do some decoding/fetching below-->
<script src="libxml.js"></script>

<!-- Extend Effects -->
<script src="extend/fefx.js"></script>

<!-- jQuery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

<!-- YouTube -->
<script src="yt.js"></script>

<!-- DailyMotion -->
<!--<script src="dm.js"></script>-->

</head>


<body>

<div class="abp" id="player">
	<div id="commentCanvas" class="container" onresize="cm.setBounds();">
		<video id="ytPlayer"><script>ytid='AEV8cBND7EY'; cid='sweetdevil';</script></video>
		<!--<video id="dmPlayer"><script>dmid='xqcwbi'; cid='comment';</script></video>-->
	</div>
</div>

<a onclick="stop();" href="javascript:;">Stop</a>
<a onclick="resume();" href="javascript:;">Resume</a>
<a onclick="load('tests/test.xml');" href="javascript:;">Run Test 1</a>
<a onclick="load('tests/test2.xml');" href="javascript:;">Run Test 2</a>
<a onclick="load('tests/rokubunnoichi.xml');" href="javascript:;">Run Test 3</a>
<a onclick="load('tests/mikunoshoushitsu.xml');" href="javascript:;">Run Test 4</a>
<a onclick="load('tests/unowen.xml');" href="javascript:;">Run Test 5</a>
<a onclick="load('tests/comment.xml');" href="javascript:;">Run Test 6</a>
<a onclick="load('tests/extended.xml');" href="javascript:;">Run Test 7</a>
<a onclick="load('tests/sweetdevil.xml');" href="javascript:;">Run Test 8</a>
<p>Filters: <a onclick="cm.filter.setRuntimeFilter(fefx.center_dim);" href="javascript:;">Apply Center-Transparency</a>
<a onclick="cm.filter.setRuntimeFilter(fefx.center_speedup);" href="javascript:;">Apply Center-Speedup</a>
<a onclick="cm.filter.setRuntimeFilter(null);" href="javascript:;">Clear Runtime Filters</a>
</p>
<script>
var cm = new CommentManager($_('commentCanvas'));
cm.init();
/*
cm.filter.addModifier(function(cmt){
	if(cmt.mode == 1)
		cmt.mode = 2;
	return cmt;
});*/
cm.filter.setRuntimeFilter(fefx.offset_dim);
var tmr=0;
var start=0;
var playhead = 0;
function load(dmf){						//glitchy.. initial load is fine.
	cm.clear();
	start = 0;
	try{
	clearInterval(tmr);
	}catch(e){}
	CommentLoader(dmf,cm);
	//resume();							//use when switching between dm, comment autostart..
}
function stop(){
	cm.stopTimer();
	clearTimeout(tmr);
}
function resume(){
	cm.startTimer();
	start = new Date().getTime() - playhead;
	try{
		clearInterval(tmr);				//make sure interval is cleared when switching dm
	}catch(e){}							//a try catch block -.- does basically nothing...
	tmr = setInterval(function(){
		playhead = new Date().getTime() - start;
		cm.time(playhead);
		//console.log('Interval: '+playhead);
	},10);
}
</script>
</body>
</html>